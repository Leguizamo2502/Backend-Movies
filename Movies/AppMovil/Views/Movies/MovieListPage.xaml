<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="AppMovil.Views.Movies.MovieListPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    BackgroundColor="{StaticResource Bg}">

    <Grid RowDefinitions="Auto,Auto,*" Padding="16">
        <Label Grid.Row="0"
           Text="{Binding Title}"
           FontAttributes="Bold"
           FontSize="22"
           TextColor="{StaticResource TextPrimary}" />

        <!-- Indicador para la primera carga -->
        <ActivityIndicator Grid.Row="1"
                       IsVisible="{Binding IsBusy}"
                       IsRunning="{Binding IsBusy}"
                       Color="{StaticResource Primary}" />

        <!-- Pull-to-refresh controlado por IsRefreshing -->
        <RefreshView Grid.Row="2"
                 IsRefreshing="{Binding IsRefreshing}"
                 Command="{Binding LoadAsyncCommand}">
            <CollectionView ItemsSource="{Binding Items}">
                <CollectionView.EmptyView>
                    <Label Text="Sin datos"
                 TextColor="{StaticResource TextSecondary}"
                 Margin="12"/>
                </CollectionView.EmptyView>

                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border Style="{StaticResource CardDark}">
                            <VerticalStackLayout Spacing="6">
                                <Label Text="{Binding Title}" Style="{StaticResource TitleLg}" />
                                <Label Text="{Binding Description}" Style="{StaticResource Body}" MaxLines="2" />
                                <Label Text="{Binding ReleaseYear}" Style="{StaticResource MetaSm}" />
                            </VerticalStackLayout>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </RefreshView>
    </Grid>
</ContentPage>
